# ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

## æ–‡ä»¶æ ‘

```
file-codes-manager/
â”‚
â”œâ”€â”€ ğŸ“„ index.html              # å‰ç«¯ä¸»é¡µé¢ï¼ˆå•é¡µåº”ç”¨ï¼‰
â”‚   â”œâ”€â”€ ç™»å½•ç•Œé¢
â”‚   â”œâ”€â”€ æ–‡æœ¬è§£æåŠŸèƒ½
â”‚   â”œâ”€â”€ åˆ—è¡¨ç®¡ç†ç•Œé¢
â”‚   â”œâ”€â”€ æœç´¢å’Œæ‰¹é‡æ“ä½œ
â”‚   â””â”€â”€ å®Œæ•´çš„æ ·å¼å’Œè„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“ functions/              # Cloudflare Functions
â”‚   â””â”€â”€ ğŸ“ api/
â”‚       â””â”€â”€ ğŸ“„ [[route]].js   # API è·¯ç”±å¤„ç†å™¨
â”‚           â”œâ”€â”€ /api/auth      # ç™»å½•éªŒè¯
â”‚           â””â”€â”€ /api/data      # æ•°æ®å­˜å–
â”‚
â”œâ”€â”€ ğŸ“„ wrangler.toml          # Cloudflare é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ é¡¹ç›®åŸºæœ¬ä¿¡æ¯
â”‚   â”œâ”€â”€ KV å‘½åç©ºé—´ç»‘å®š
â”‚   â””â”€â”€ ç¯å¢ƒé…ç½®
â”‚
â”œâ”€â”€ ğŸ“„ package.json           # Node.js ä¾èµ–é…ç½®
â”‚   â””â”€â”€ éƒ¨ç½²è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“„ .gitignore             # Git å¿½ç•¥è§„åˆ™
â”œâ”€â”€ ğŸ“„ _headers               # HTTP å®‰å…¨å¤´
â”œâ”€â”€ ğŸ“„ .dev.vars.example      # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚
â”œâ”€â”€ ğŸ“– README.md              # é¡¹ç›®ä¸»æ–‡æ¡£
â”œâ”€â”€ ğŸ“– DEPLOYMENT.md          # è¯¦ç»†éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ ğŸ“– QUICKSTART.md          # å¿«é€Ÿå¼€å§‹æŒ‡å—
â””â”€â”€ ğŸ“– STRUCTURE.md           # æœ¬æ–‡æ¡£
```

---

## æ ¸å¿ƒæ–‡ä»¶è¯¦è§£

### 1. index.html (å‰ç«¯åº”ç”¨)

**åŠŸèƒ½æ¨¡å—ï¼š**

```
index.html
â”‚
â”œâ”€â”€ ğŸ¨ æ ·å¼å±‚ (CSS)
â”‚   â”œâ”€â”€ å…¨å±€æ ·å¼å’Œå˜é‡
â”‚   â”œâ”€â”€ ç™»å½•ç•Œé¢æ ·å¼
â”‚   â”œâ”€â”€ ä¸»ç•Œé¢æ ·å¼
â”‚   â”œâ”€â”€ å¡ç‰‡å’Œè¡¨å•æ ·å¼
â”‚   â”œâ”€â”€ åˆ—è¡¨é¡¹æ ·å¼
â”‚   â”œâ”€â”€ æ¨¡æ€æ¡†å’Œé€šçŸ¥
â”‚   â””â”€â”€ å“åº”å¼å¸ƒå±€
â”‚
â”œâ”€â”€ ğŸ—ï¸ ç»“æ„å±‚ (HTML)
â”‚   â”œâ”€â”€ ç™»å½•å±å¹• (#loginScreen)
â”‚   â”‚   â””â”€â”€ å¯†ç è¾“å…¥æ¡†
â”‚   â”‚
â”‚   â””â”€â”€ ä¸»ç•Œé¢ (#mainScreen)
â”‚       â”œâ”€â”€ é¡¶éƒ¨å¯¼èˆª
â”‚       â”œâ”€â”€ ç»Ÿè®¡å¡ç‰‡
â”‚       â”œâ”€â”€ æ–‡æœ¬è§£æåŒº
â”‚       â”œâ”€â”€ æ‰‹åŠ¨æ·»åŠ åŒº
â”‚       â”œâ”€â”€ æœç´¢æ¡†
â”‚       â”œâ”€â”€ æ‰¹é‡æ“ä½œæ 
â”‚       â””â”€â”€ æ–‡ä»¶ç åˆ—è¡¨
â”‚
â””â”€â”€ âš¡ é€»è¾‘å±‚ (JavaScript)
    â”œâ”€â”€ ç™»å½•æ¨¡å—
    â”‚   â”œâ”€â”€ login()          # ç™»å½•å¤„ç†
    â”‚   â”œâ”€â”€ sha256()         # å¯†ç å“ˆå¸Œ
    â”‚   â”œâ”€â”€ checkSession()   # ä¼šè¯æ£€æŸ¥
    â”‚   â””â”€â”€ logout()         # é€€å‡ºç™»å½•
    â”‚
    â”œâ”€â”€ æ•°æ®æ¨¡å—
    â”‚   â”œâ”€â”€ loadData()       # ä» API åŠ è½½
    â”‚   â”œâ”€â”€ saveData()       # ä¿å­˜åˆ° API
    â”‚   â””â”€â”€ exportData()     # å¯¼å‡º JSON
    â”‚
    â”œâ”€â”€ è§£ææ¨¡å—
    â”‚   â”œâ”€â”€ parseText()      # è§£ææ–‡æœ¬
    â”‚   â””â”€â”€ addManual()      # æ‰‹åŠ¨æ·»åŠ 
    â”‚
    â”œâ”€â”€ åˆ—è¡¨æ¨¡å—
    â”‚   â”œâ”€â”€ renderList()     # æ¸²æŸ“åˆ—è¡¨
    â”‚   â”œâ”€â”€ editNote()       # ç¼–è¾‘å¤‡æ³¨
    â”‚   â”œâ”€â”€ saveNote()       # ä¿å­˜å¤‡æ³¨
    â”‚   â”œâ”€â”€ deleteItem()     # åˆ é™¤å•é¡¹
    â”‚   â””â”€â”€ copyCode()       # å¤åˆ¶æ–‡ä»¶ç 
    â”‚
    â”œâ”€â”€ æ‰¹é‡æ“ä½œæ¨¡å—
    â”‚   â”œâ”€â”€ toggleSelectMode()  # åˆ‡æ¢é€‰æ‹©æ¨¡å¼
    â”‚   â”œâ”€â”€ toggleSelect()      # åˆ‡æ¢å•é¡¹é€‰æ‹©
    â”‚   â”œâ”€â”€ batchDelete()       # æ‰¹é‡åˆ é™¤
    â”‚   â””â”€â”€ cancelSelection()   # å–æ¶ˆé€‰æ‹©
    â”‚
    â”œâ”€â”€ æœç´¢æ¨¡å—
    â”‚   â””â”€â”€ filterList()     # è¿‡æ»¤åˆ—è¡¨
    â”‚
    â””â”€â”€ UI è¾…åŠ©
        â”œâ”€â”€ showNotification() # æ˜¾ç¤ºé€šçŸ¥
        â””â”€â”€ escapeHtml()       # HTML è½¬ä¹‰
```

**ç‰¹ç‚¹ï¼š**
- âœ… çº¯å‰ç«¯ï¼Œæ— éœ€æ„å»º
- âœ… è‡ªåŒ…å«ï¼ˆHTML + CSS + JS ä¸€ä½“ï¼‰
- âœ… å“åº”å¼è®¾è®¡
- âœ… æ·±è‰²ä¸»é¢˜
- âœ… æ— å¤–éƒ¨ä¾èµ–

---

### 2. functions/api/[[route]].js (åç«¯ API)

**åŠŸèƒ½æ¨¡å—ï¼š**

```
[[route]].js
â”‚
â”œâ”€â”€ ğŸ”’ å®‰å…¨æ¨¡å—
â”‚   â”œâ”€â”€ generateSessionId()   # ç”Ÿæˆä¼šè¯ ID
â”‚   â”œâ”€â”€ verifySession()        # éªŒè¯ä¼šè¯
â”‚   â””â”€â”€ checkRateLimit()       # é¢‘ç‡é™åˆ¶
â”‚
â”œâ”€â”€ ğŸ”€ è·¯ç”±å¤„ç†
â”‚   â”œâ”€â”€ onRequest()            # ä¸»å¤„ç†å‡½æ•°
â”‚   â”œâ”€â”€ handleAuth()           # POST /api/auth
â”‚   â”œâ”€â”€ handleGetData()        # GET /api/data
â”‚   â””â”€â”€ handleSaveData()       # POST /api/data
â”‚
â”œâ”€â”€ ğŸ’¾ æ•°æ®æ“ä½œ
â”‚   â”œâ”€â”€ KV è¯»å–
â”‚   â”œâ”€â”€ KV å†™å…¥
â”‚   â””â”€â”€ æ•°æ®éªŒè¯
â”‚
â””â”€â”€ ğŸŒ HTTP è¾…åŠ©
    â”œâ”€â”€ CORS å¤„ç†
    â”œâ”€â”€ JSON å“åº”
    â””â”€â”€ é”™è¯¯å¤„ç†
```

**API ç«¯ç‚¹ï¼š**

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | è®¤è¯ |
|------|------|------|------|
| `/api/auth` | POST | ç™»å½•éªŒè¯ | âŒ |
| `/api/data` | GET | è·å–æ•°æ® | âœ… |
| `/api/data` | POST | ä¿å­˜æ•°æ® | âœ… |

**ç‰¹ç‚¹ï¼š**
- âœ… è‡ªåŠ¨è·¯ç”±åŒ¹é… `[[route]]`
- âœ… Session ä¼šè¯ç®¡ç†
- âœ… Rate limiting é˜²æŠ¤
- âœ… KV å­˜å‚¨é›†æˆ
- âœ… CORS æ”¯æŒ

---

### 3. wrangler.toml (Cloudflare é…ç½®)

**é…ç½®é¡¹ï¼š**

```toml
[é¡¹ç›®ä¿¡æ¯]
name                      # é¡¹ç›®åç§°
compatibility_date        # å…¼å®¹æ€§æ—¥æœŸ

[Pages é…ç½®]
pages_build_output_dir    # æ„å»ºè¾“å‡ºç›®å½•

[KV ç»‘å®š]
binding                   # å˜é‡åï¼ˆåœ¨ä»£ç ä¸­ä½¿ç”¨ï¼‰
id                        # KV å‘½åç©ºé—´ ID

[ç¯å¢ƒé…ç½®]
[env.development]         # å¼€å‘ç¯å¢ƒ
[env.production]          # ç”Ÿäº§ç¯å¢ƒ
```

**ç‰¹ç‚¹ï¼š**
- âœ… å®šä¹‰ KV ç»‘å®š
- âœ… å¤šç¯å¢ƒæ”¯æŒ
- âœ… Wrangler CLI ä½¿ç”¨

---

## æ•°æ®æµå‘

### ç™»å½•æµç¨‹

```
ç”¨æˆ·è¾“å…¥å¯†ç 
    â†“
å‰ç«¯ SHA-256 å“ˆå¸Œ
    â†“
POST /api/auth
    â†“
åç«¯éªŒè¯å“ˆå¸Œ
    â†“
ç”Ÿæˆ Session ID
    â†“
è¿”å›å‰ç«¯
    â†“
å­˜å…¥ sessionStorage
    â†“
åç»­è¯·æ±‚å¸¦ X-Session header
```

### æ•°æ®ä¿å­˜æµç¨‹

```
ç”¨æˆ·æ“ä½œï¼ˆæ·»åŠ /ç¼–è¾‘/åˆ é™¤ï¼‰
    â†“
æ›´æ–°å‰ç«¯ fileData æ•°ç»„
    â†“
POST /api/data
    â†“
éªŒè¯ Session
    â†“
å†™å…¥ KV: FILE_CODES_LIST
    â†“
è¿”å›æˆåŠŸ
    â†“
å‰ç«¯æ˜¾ç¤ºé€šçŸ¥
```

### æ•°æ®åŠ è½½æµç¨‹

```
é¡µé¢åŠ è½½/ç™»å½•æˆåŠŸ
    â†“
GET /api/data
    â†“
éªŒè¯ Session
    â†“
ä» KV è¯»å–: FILE_CODES_LIST
    â†“
è¿”å› JSON æ•°æ®
    â†“
å‰ç«¯æ¸²æŸ“åˆ—è¡¨
```

---

## æŠ€æœ¯æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Cloudflare Global Network       â”‚
â”‚              (CDN + Edge)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Static      â”‚       â”‚  Functions   â”‚
â”‚  Assets      â”‚       â”‚  (Serverless)â”‚
â”‚              â”‚       â”‚              â”‚
â”‚  index.html  â”‚       â”‚  [[route]].jsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Workers KV      â”‚
                    â”‚  (Key-Value DB)  â”‚
                    â”‚                  â”‚
                    â”‚  FILE_CODES_LIST â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## éƒ¨ç½²æ¶æ„

```
å¼€å‘ç¯å¢ƒ                     ç”Ÿäº§ç¯å¢ƒ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Local  â”‚                â”‚ GitHub  â”‚
â”‚  Files  â”‚                â”‚  Repo   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                          â”‚
     â”‚ wrangler                 â”‚ Git Push
     â”‚ pages deploy             â”‚
     â”‚                          â”‚
     â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Cloudflare Dashboard         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   KV    â”‚     â”‚  Pages  â”‚    â”‚
â”‚  â”‚  Setup  â”‚â”€â”€â”€â”€â–¶â”‚  Deploy â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚              â”‚         â”‚
â”‚         â”‚  Binding     â”‚         â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Production     â”‚
    â”‚  your-app.pages  â”‚
    â”‚      .dev        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¯å¢ƒå˜é‡å’Œå¯†é’¥

### ç¯å¢ƒå˜é‡ä½ç½®

| ç¯å¢ƒ | ä½ç½® | ç”¨é€” |
|------|------|------|
| æœ¬åœ°å¼€å‘ | `.dev.vars` | Wrangler æœ¬åœ°è¿è¡Œ |
| ç”Ÿäº§ç¯å¢ƒ | Dashboard | Pages ç¯å¢ƒå˜é‡ |
| é¢„è§ˆç¯å¢ƒ | Dashboard | Pages ç¯å¢ƒå˜é‡ |

### å¿…éœ€çš„é…ç½®

| é…ç½®é¡¹ | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|--------|------|------|------|
| `PASSWORD_HASH` | ç¯å¢ƒå˜é‡ | âœ… | å¯†ç  SHA-256 å“ˆå¸Œ |
| `FILE_CODES_KV` | KV ç»‘å®š | âœ… | KV å‘½åç©ºé—´ç»‘å®š |

---

## æ–‡ä»¶å¤§å°å’Œæ€§èƒ½

| æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|------|------|------|
| index.html | ~25KB | å‹ç¼©åæ›´å° |
| [[route]].js | ~8KB | è¾¹ç¼˜è®¡ç®— |
| æ€»è®¡ | ~33KB | æå°ä½“ç§¯ |

**æ€§èƒ½ç‰¹ç‚¹ï¼š**
- âš¡ å…¨çƒ CDN åˆ†å‘
- âš¡ è¾¹ç¼˜è®¡ç®—ï¼ˆæ¥è¿‘ç”¨æˆ·ï¼‰
- âš¡ 0 å†·å¯åŠ¨ï¼ˆPages Functionsï¼‰
- âš¡ æ¯«ç§’çº§å“åº”

---

## æ‰©å±•å’Œå®šåˆ¶

### æ·»åŠ æ–°çš„æ–‡ä»¶ç æ ¼å¼

ç¼–è¾‘ `index.html` ä¸­çš„ `parseText()` å‡½æ•°ï¼š

```javascript
const patterns = [
    /@filepan_bot:([a-zA-Z0-9_-]+)/g,
    /showfilesbot_([a-zA-Z0-9_-]+)/g,
    /ä½ çš„æ–°æ ¼å¼_([a-zA-Z0-9_-]+)/g,  // æ·»åŠ è¿™é‡Œ
];
```

### æ·»åŠ æ–°çš„ API ç«¯ç‚¹

ç¼–è¾‘ `functions/api/[[route]].js`ï¼š

```javascript
if (path === 'your-new-endpoint') {
    return await handleYourEndpoint(request, env);
}
```

### ä¿®æ”¹ä¸»é¢˜é¢œè‰²

ç¼–è¾‘ `index.html` ä¸­çš„ CSS å˜é‡ï¼š

```css
:root {
    --primary-color: #60a5fa;  /* ä¿®æ”¹ä¸»è‰²è°ƒ */
    --bg-color: #1e1e2e;       /* ä¿®æ”¹èƒŒæ™¯è‰² */
}
```

---

## é™åˆ¶å’Œé…é¢

### Cloudflare å…è´¹ç‰ˆé™åˆ¶

| èµ„æº | é™åˆ¶ | è¯´æ˜ |
|------|------|------|
| KV è¯»å– | 100,000/å¤© | è¶³å¤Ÿä¸ªäººä½¿ç”¨ |
| KV å†™å…¥ | 1,000/å¤© | è¶³å¤Ÿä¸ªäººä½¿ç”¨ |
| KV å­˜å‚¨ | 1GB | å¯å­˜å‚¨å¤§é‡æ–‡ä»¶ç  |
| Functions è¯·æ±‚ | 100,000/å¤© | è¶³å¤Ÿä¸ªäººä½¿ç”¨ |
| å¸¦å®½ | æ— é™ | âœ… |

### åº”ç”¨å±‚é™åˆ¶

| é™åˆ¶é¡¹ | å€¼ | ä½ç½® |
|--------|------|------|
| å•æ¬¡æ•°æ®å¤§å° | 5MB | `[[route]].js` |
| Rate Limit | 100 req/min/IP | `[[route]].js` |
| Session è¿‡æœŸ | 24 å°æ—¶ | `[[route]].js` |

---

## æœ€ä½³å®è·µ

### 1. å®‰å…¨
- âœ… ä½¿ç”¨å¼ºå¯†ç ï¼ˆ16+ å­—ç¬¦ï¼‰
- âœ… å®šæœŸæ›´æ¢å¯†ç 
- âœ… ä¸æš´éœ²éƒ¨ç½² URL
- âœ… ç›‘æ§è®¿é—®æ—¥å¿—

### 2. æ•°æ®
- âœ… å®šæœŸå¯¼å‡ºå¤‡ä»½
- âœ… éªŒè¯å¯¼å…¥æ•°æ®
- âœ… æ§åˆ¶æ•°æ®å¤§å°

### 3. æ€§èƒ½
- âœ… åˆ©ç”¨ CDN ç¼“å­˜
- âœ… å‡å°‘ KV å†™å…¥é¢‘ç‡
- âœ… å®¢æˆ·ç«¯æ•°æ®ç¼“å­˜

### 4. ç»´æŠ¤
- âœ… ç›‘æ§ KV ä½¿ç”¨é‡
- âœ… å®šæœŸæ£€æŸ¥æ—¥å¿—
- âœ… åŠæ—¶æ›´æ–°ä¾èµ–

---

## ç›¸å…³èµ„æº

- ğŸ“š Cloudflare Pages æ–‡æ¡£: https://developers.cloudflare.com/pages/
- ğŸ“š Workers KV æ–‡æ¡£: https://developers.cloudflare.com/kv/
- ğŸ“š Functions æ–‡æ¡£: https://developers.cloudflare.com/pages/functions/
- ğŸ“š Wrangler æ–‡æ¡£: https://developers.cloudflare.com/workers/wrangler/

---

**ç†è§£é¡¹ç›®ç»“æ„ï¼Œè½»æ¾å®šåˆ¶å’Œæ‰©å±•ï¼** ğŸš€

